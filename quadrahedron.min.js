var quadrahedron={},qh=quadrahedron;qh.getType=function(e){var n=Object.prototype.toString;return jQuery.isPlainObject(e)?"object":"string"==typeof e?"string":"[object Array]"==n.call([])?"array":void 0},qh.checkList=function(e){var n=function(n,o){e[n]=e[n]||o},e=e||{};n("verbose",!1),n("silent",!1);var o={requirejs:function(){return!("undefined"==typeof requirejs)},jQuery:function(){return!("undefined"==typeof jQuery)},angular:function(){return!("undefined"==typeof angular)},moduleCount:function(){return qh.moduleManager.qhModules.getPaths("module").length}},t=!0;for(var a in o){var r=o[a],u=r(),l="FAILED",d="error";u?(l="Success",d="log"):t=!1,!e.verbose&&u||e.silent||console[d]("Checking",a,":",l)}return t},qh.modules=function(e,n){var o=qh.moduleLoader;switch(qh.getType(e)){case"string":n?o.loadModulesInPath(n,e):o.loadModuleList(e);break;case"object":o.loadModuleConfig(e);break;case"array":o.loadModulesByArray(e)}qh.loader.load()},qh.app=function(e){qh.moduleManager.app.getAppElement=e},qh.preloader=function(e){qh.loader.getPreloaderElement=e},qh.loader=function(){var e={};return e.loaded=!1,e.readyFunctions=[],e.getPreloaderElement=function(){},e.load=function(){qh.checkList({silent:!0})&&$(function(){requirejs(qh.moduleManager.qhModules.getPaths("module"),function(){requirejs(qh.moduleManager.qhModules.getPaths("component"),function(){if(e.loaded=!0,!qh.moduleManager.app.modules.length)throw"No app element is set. A module must have a configuration property 'app' set to 'true'.";try{angular.bootstrap(qh.moduleManager.app.getAppElement(),qh.moduleManager.app.modules),$(e.getPreloaderElement()).hide(),angular.forEach(e.readyFunctions,function(e){e()})}catch(n){console.error(n.stack||n.message||n)}})})})},e}(),qh.moduleLoader=function(){var e={};return e.loadModuleConfig=function(n){var o=n,t=o.basePath||"";if(o.src&&e.loadModuleList(o.src),o.list)switch(qh.getType(o.list)){case"array":e.loadModulesInPath(o.list,t);break;case"object":console.error("Loading config objects is not supported yet")}},e.loadModuleList=function(n){jQuery.getJSON(n,function(n){e.loadModuleConfig(n),qh.loader.load()}).fail(function(){throw"Module listing JSON at "+n+" is invalid."})},e.loadModulesInPath=function(e,n){for(var o in e)var t=e[o],a=qh.moduleManager.qhModules.add(t,n)},e.loadModulesByArray=function(n){return e.loadModulesInPath(n)},e.loadModuleComponent=function(){console.error("Should there really be module components loaded from here.")},e}(),qh.ready=function(e){qh.loader.readyFunctions.push(e)},qh.moduleManager=function(){var e={};return e.qhModules=function(){var e={};return e.qhModule=function(n,o){var t=this;t.name=n,t.basePath=o||"module",t.getPath=function(){return t.basePath+"/"+t.name},t.getConfigFilePath=function(){return t.getPath()+"/module.js"},t.getComponent=function(e,n){if(t.components[e][n])return t.components[e][n];throw"No component in module '"+t.name+"' with a '"+e+"' named '"+n+"'"},t.components={},t.addComponent=function(n,o){return t.components[n]||(t.components[n]={}),t.components[n][o]=new e.qhModuleComponent(t.name,n,o),t.getComponent(n,o)},t.getComponentPaths=function(){var e=[];return jQuery.each(t.components,function(n,o){jQuery.each(o,function(n,o){e.push(o.getPath())})}),e}},e.qhModuleComponent=function(n,o,t){var a=this;a.name=t,a.type=o,a.qhModule=e.get(n),a.getPath=function(){return[a.qhModule.getPath(),a.type,a.name].join("/")+".js"},a.getFullName=function(){return[a.qhModule.name,a.type,a.name].join(".")}},e.list={},e.add=function(n,o){return e.list[n]=new e.qhModule(n,o),e.get(n)},e.get=function(n){var o=e.list[n];if(!o)throw"Attempted to get module '"+n+"' which doesn't exist.";return o},e.getPaths=function(n){var o=[];return angular.forEach(e.list,function(e){switch(n){case"module":o.push(e.getConfigFilePath());break;case"component":o=o.concat(e.getComponentPaths())}}),o},e}(),e.app={getAppElement:function(){},modules:[]},e.angularModules={},e.setModule=function(n,o){var t=e.qhModules.get(n),a=[];jQuery.each(o,function(e,n){switch(e){case"app":break;case"require":a=n;break;default:var o=n;angular.forEach(o,function(n){t.addComponent(e,n)})}}),e.angularModules[n]=angular.module(n,a),o.app&&e.app.modules.push(n)},e.checkRequiredModules=function(){var e=qh.moduleManager.angularModules,n={},o=[];return angular.forEach(e,function(e,o){n[o]=n[o]||!1,e.requires.length>0&&(n[o]=!0,angular.forEach(e.requires,function(e){n[e]=!0}))}),angular.forEach(n,function(e,n){e||o.push(n)}),o.length>0?["Modules loaded but not required by any module: "+o.join(",")]:[]},e}(),qh.setModule=function(e,n){qh.moduleManager.setModule(e,n)},qh.getModule=function(e){if(qh.moduleManager.angularModules[e])return qh.moduleManager.angularModules[e];throw"Unknown Module Exception. '"+e+"' is not recognised. The module name must be one of: "+Object.keys(qh.moduleManager.angularModules).join(", ")},qh.getQHModule=function(e){return qh.moduleManager.qhModules.get(e)},qh.component=function(e,n){return n(qh.getModule(e),qh.getQHModule(e))},qh.debug=function(){var e=[];return e=e.concat(quadrahedron.moduleManager.checkRequiredModules())},qh.bootstrap=function(){return angular.bootstrap(qh.moduleManager.app.getAppElement(),qh.moduleManager.app.modules)};